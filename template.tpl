___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Send pixel from browser",
  "categories": ["CONVERSIONS", "ADVERTISING", "REMARKETING", "TAG_MANAGEMENT"],
  "brand": {
    "id": "bossdata",
    "displayName": "Bossdata",
    "thumbnail": "data:image/jpeg;base64,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\u003d"
  },
  "description": "Sends a command to the browser to load the provided URL as an \u003cimg\u003e tag. This command protocol is supported in the Google Analytics: GA4 Configuration and Google Analytics: GA Event web tags.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "pixelUrl",
    "displayName": "IMG pixel URL",
    "simpleValueType": true,
    "help": "This is the base url without the query string attached to it.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "alwaysInSummary": true
  },
  {
    "type": "TEXT",
    "name": "urlAdresSeparator",
    "displayName": "URL Query Sring Separator",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "This identifies the beginning of the query string and must be placed at the end of the link, before the contents of the query string.",
    "valueHint": "?"
  },
  {
    "type": "TEXT",
    "name": "urlVariableSeparator",
    "displayName": "URL Variable Separator",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "This is used before each subsequent variable/value pair in the query string.",
    "valueHint": "\u0026"
  },
  {
    "type": "TEXT",
    "name": "urlValueSeparator",
    "displayName": "URL Value Separator",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "This separates the variable from the value assigned to that variable.",
    "valueHint": "\u003d"
  },
  {
    "type": "GROUP",
    "name": "customDataListGroup",
    "displayName": "Custom Data",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "customDataList",
        "displayName": "",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Field Name",
            "name": "name",
            "type": "TEXT"
          },
          {
            "defaultValue": "",
            "displayName": "Field Value",
            "name": "value",
            "type": "TEXT"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "loggingPermissionGroup",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SELECT",
        "name": "logType",
        "displayName": "",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "debug",
            "displayValue": "debug"
          },
          {
            "value": "yes",
            "displayValue": "yes"
          },
          {
            "value": "no",
            "displayValue": "no"
          }
        ],
        "simpleValueType": true
      }
    ],
    "displayName": "Logging settings"
  }
]


___SANDBOXED_JS_FOR_SERVER___

const logToConsole = require('logToConsole');
const getContainerVersion = require('getContainerVersion');
const containerVersion = getContainerVersion();
const isDebug = containerVersion.debugMode;
const isLoggingEnabled = determinateIsLoggingEnabled();
const sendPixelFromBrowser = require('sendPixelFromBrowser');
const encodeUriComponent = require('encodeUriComponent');

const CUSTOM_DATA = data.customDataList;

let pixel_url = data.pixelUrl;
const adres_separator = data.urlAdresSeparator || '';
const value_separator = data.urlValueSeparator || '';
const variable_separator = data.urlVariableSeparator || '';

let i = 1;

if(data.customDataList){ 
  data.customDataList.forEach((item, index) => {
    if (i ==1){
      pixel_url += adres_separator +encodeUriComponent(item.name)+value_separator+encodeUriComponent(item.value);
      
    }else{
      
      pixel_url += variable_separator+encodeUriComponent(item.name)+value_separator+encodeUriComponent(item.value);
      
    }
    
    i++;

  });
}

logToConsole(pixel_url);

sendPixelFromBrowser(pixel_url);


function determinateIsLoggingEnabled() {
    if (!data.logType) {
        return isDebug;
    }

    if (data.logType === 'no') {
        return false;
    }

    if (data.logType === 'debug') {
        return isDebug;
    }

    return data.logType === 'always';
}

data.gtmOnSuccess();


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel_from_browser",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 10-11-2022 16:09:03


